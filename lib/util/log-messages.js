'use strict';

const cachePrefix = require('.').cachePrefix;
const LoggerFactory = require('../loggerFactory');

exports.moduleFreezeError = (compilation, module, e) => {
  const loggerSerial = LoggerFactory.getLogger(compilation).from('serial');
  const compilerName = compilation.compiler.name;
  const compilerContext = compilation.compiler.options.context;
  const identifierPrefix = cachePrefix(compilation);
  const moduleIdentifier = module.identifier();
  const shortener = new (require('webpack/lib/RequestShortener'))(compilerContext);
  const moduleReadable = module.readableIdentifier(shortener);

  loggerSerial.error({
    id: 'serialization--error-freezing-module',
    identifierPrefix,
    compilerName,
    moduleIdentifier,
    moduleReadable,
    error: e,
    errorMessage: e.message,
    errorStack: e.stack
  }, `Unable to freeze module "${moduleReadable}${compilerName ? `" in compilation "${compilerName}` : ''}". An error occured serializing it into a string: ${e.message}`);
};

exports.cacheNoParity = (compiler, { parityRoot }) => {
  const loggerSerial = new LoggerFactory(compiler).create().from('serial');
  loggerSerial.error({
    id: 'serialzation--cache-incomplete',
    parityRoot
  }, [`Previous cache did not complete parity check. ${parityRoot.reason}`, 'Resetting cache.'].join('\n'));
};

exports.serialBadCache = (compiler, error) => {
  const loggerSerial = new LoggerFactory(compiler).create().from('serial');
  loggerSerial.error({
    id: 'serialzation--bad-cache'
  }, ['Cache is corrupted.', error.stack || error.message || error].join('\n'));
};

const logCore = compiler => new LoggerFactory(compiler).create().from('core');

exports.configHashSetButNotUsed = (compiler, { cacheDirectory }) => {
  const loggerCore = logCore(compiler);
  loggerCore.error({
    id: 'confighash--directory-no-confighash',
    cacheDirectory: cacheDirectory
  }, 'HardSourceWebpackPlugin cannot use [confighash] in cacheDirectory ' + 'without configHash option being set and returning a non-falsy value.');
};

exports.configHashFirstBuild = (compiler, { cacheDirPath, configHash }) => {
  const loggerCore = logCore(compiler);
  loggerCore.log({
    id: 'confighash--new',
    cacheDirPath,
    configHash
  }, `HardSourceWebpackPlugin is writing to a new confighash path for the first time: ${cacheDirPath}`);
};

exports.configHashBuildWith = (compiler, { cacheDirPath, configHash }) => {
  const loggerCore = logCore(compiler);
  loggerCore.log({
    id: 'confighash--reused',
    cacheDirPath,
    configHash
  }, `HardSourceWebpackPlugin is reading from and writing to a confighash path: ${cacheDirPath}`);
};

exports.deleteOldCaches = (compiler, { newTotalSize, oldTotalSize }) => {
  const loggerCore = logCore(compiler);
  const sizeMB = Math.ceil(newTotalSize / 1024 / 1024);
  const deletedSizeMB = Math.ceil(oldTotalSize / 1024 / 1024);
  loggerCore.log({
    id: 'caches--delete-old',
    size: newTotalSize,
    sizeMB,
    deletedSize: oldTotalSize,
    deletedSizeMB
  }, `HardSourceWebpackPlugin is using ${sizeMB} MB of disk space after deleting ${deletedSizeMB} MB.`);
};

exports.keepCaches = (compiler, { totalSize }) => {
  const loggerCore = logCore(compiler);
  const sizeMB = Math.ceil(totalSize / 1024 / 1024);
  loggerCore.log({
    id: 'caches--keep',
    size: totalSize,
    sizeMB
  }, `HardSourceWebpackPlugin is using ${sizeMB} MB of disk space.`);
};

exports.environmentInputs = (compiler, { inputs }) => {
  const loggerCore = logCore(compiler);
  loggerCore.log({
    id: 'environment--inputs',
    inputs
  }, `Tracking environment changes with ${inputs.join(', ')}.`);
};

exports.configHashChanged = compiler => {
  const loggerCore = logCore(compiler);
  loggerCore.warn({
    id: 'environment--config-changed'
  }, 'Environment has changed (configuration was changed).\n' + 'HardSourceWebpackPlugin will reset the cache and store a fresh one.');
};

exports.environmentHashChanged = compiler => {
  const loggerCore = logCore(compiler);
  loggerCore.warn({
    id: 'environment--changed'
  }, 'Environment has changed (node_modules was updated).\n' + 'HardSourceWebpackPlugin will reset the cache and store a fresh one.');
};

exports.hardSourceVersionChanged = compiler => {
  const loggerCore = logCore(compiler);
  loggerCore.warn({
    id: 'environment--hardsource-changed'
  }, 'Installed HardSource version does not match the saved ' + 'cache.\nHardSourceWebpackPlugin will reset the cache and store ' + 'a fresh one.');
};

exports.childCompilerWithoutCache = compilation => {
  var loggerUtil = LoggerFactory.getLogger(compilation).from('util');
  loggerUtil.error({
    id: 'childcompiler--no-cache',
    compilerName: compilation.compiler.name
  }, [`A child compiler (${compilation.compiler.name}) does not`, "have a memory cache. Enable a memory cache with webpack's", '`cache` configuration option. HardSourceWebpackPlugin will be', 'disabled for this child compiler until then.'].join('\n'));
};

exports.childCompilerUnnamedCache = compilation => {
  var loggerUtil = LoggerFactory.getLogger(compilation).from('util');
  loggerUtil.error({
    id: 'childcompiler--unnamed-cache',
    compilerName: compilation.compiler.name
  }, [`A child compiler (${compilation.compiler.name}) has a`, 'memory cache but its cache name is unknown.', 'HardSourceWebpackPlugin will be disabled for this child', 'compiler.'].join('\n'));
};

const logParallel = compiler => new LoggerFactory(compiler).create().from('parallel');

exports.parallelStartWorkers = (compiler, options) => {
  const loggerParallel = logParallel(compiler);
  loggerParallel.log({
    id: 'parallel--start-workers',
    numWorkers: options.numWorkers
  }, [`Start ${options.numWorkers} module workers.`].join('\n'));
};

exports.parallelConfigMismatch = (compiler, options) => {
  const loggerParallel = logParallel(compiler);
  loggerParallel.error({
    id: 'parallel--config-mismatch',
    ourHash: options.ourHash,
    theirHash: options.theirHash
  }, [`Child process's configuration does not match parent `, `configuration. Unable to parallelize webpack.`].join('\n'));
};

exports.parallelErrorSendingJob = (compiler, error) => {
  const loggerParallel = logParallel(compiler);
  loggerParallel.error({
    id: 'parallel--error-sending-job',
    error
  }, `Failed to send parallel module work. ${error.stack}`);
};

exports.parallelRequireWebpack4 = compiler => {
  const loggerParallel = logParallel(compiler);
  loggerParallel.error({
    id: 'parallel--webpack-4'
  }, `Parallel Module Plugin requires webpack 4.`);
};
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImhhcmQtc291cmNlLXdlYnBhY2stcGx1Z2luL2xpYi91dGlsL2xvZy1tZXNzYWdlcy5qcyJdLCJuYW1lcyI6WyJjYWNoZVByZWZpeCIsInJlcXVpcmUiLCJMb2dnZXJGYWN0b3J5IiwiZXhwb3J0cyIsIm1vZHVsZUZyZWV6ZUVycm9yIiwiY29tcGlsYXRpb24iLCJtb2R1bGUiLCJlIiwibG9nZ2VyU2VyaWFsIiwiZ2V0TG9nZ2VyIiwiZnJvbSIsImNvbXBpbGVyTmFtZSIsImNvbXBpbGVyIiwibmFtZSIsImNvbXBpbGVyQ29udGV4dCIsIm9wdGlvbnMiLCJjb250ZXh0IiwiaWRlbnRpZmllclByZWZpeCIsIm1vZHVsZUlkZW50aWZpZXIiLCJpZGVudGlmaWVyIiwic2hvcnRlbmVyIiwibW9kdWxlUmVhZGFibGUiLCJyZWFkYWJsZUlkZW50aWZpZXIiLCJlcnJvciIsImlkIiwiZXJyb3JNZXNzYWdlIiwibWVzc2FnZSIsImVycm9yU3RhY2siLCJzdGFjayIsImNhY2hlTm9QYXJpdHkiLCJwYXJpdHlSb290IiwiY3JlYXRlIiwicmVhc29uIiwiam9pbiIsInNlcmlhbEJhZENhY2hlIiwibG9nQ29yZSIsImNvbmZpZ0hhc2hTZXRCdXROb3RVc2VkIiwiY2FjaGVEaXJlY3RvcnkiLCJsb2dnZXJDb3JlIiwiY29uZmlnSGFzaEZpcnN0QnVpbGQiLCJjYWNoZURpclBhdGgiLCJjb25maWdIYXNoIiwibG9nIiwiY29uZmlnSGFzaEJ1aWxkV2l0aCIsImRlbGV0ZU9sZENhY2hlcyIsIm5ld1RvdGFsU2l6ZSIsIm9sZFRvdGFsU2l6ZSIsInNpemVNQiIsIk1hdGgiLCJjZWlsIiwiZGVsZXRlZFNpemVNQiIsInNpemUiLCJkZWxldGVkU2l6ZSIsImtlZXBDYWNoZXMiLCJ0b3RhbFNpemUiLCJlbnZpcm9ubWVudElucHV0cyIsImlucHV0cyIsImNvbmZpZ0hhc2hDaGFuZ2VkIiwid2FybiIsImVudmlyb25tZW50SGFzaENoYW5nZWQiLCJoYXJkU291cmNlVmVyc2lvbkNoYW5nZWQiLCJjaGlsZENvbXBpbGVyV2l0aG91dENhY2hlIiwibG9nZ2VyVXRpbCIsImNoaWxkQ29tcGlsZXJVbm5hbWVkQ2FjaGUiLCJsb2dQYXJhbGxlbCIsInBhcmFsbGVsU3RhcnRXb3JrZXJzIiwibG9nZ2VyUGFyYWxsZWwiLCJudW1Xb3JrZXJzIiwicGFyYWxsZWxDb25maWdNaXNtYXRjaCIsIm91ckhhc2giLCJ0aGVpckhhc2giLCJwYXJhbGxlbEVycm9yU2VuZGluZ0pvYiIsInBhcmFsbGVsUmVxdWlyZVdlYnBhY2s0Il0sIm1hcHBpbmdzIjoiOztBQUFBLE1BQU1BLGNBQWNDLFFBQVEsR0FBUixFQUFhRCxXQUFqQztBQUNBLE1BQU1FLGdCQUFnQkQsMkJBQXRCOztBQUVBRSxRQUFRQyxpQkFBUixHQUE0QixDQUFDQyxXQUFELEVBQWNDLE1BQWQsRUFBc0JDLENBQXRCLEtBQTRCO0FBQ3RELFFBQU1DLGVBQWVOLGNBQWNPLFNBQWQsQ0FBd0JKLFdBQXhCLEVBQXFDSyxJQUFyQyxDQUEwQyxRQUExQyxDQUFyQjtBQUNBLFFBQU1DLGVBQWVOLFlBQVlPLFFBQVosQ0FBcUJDLElBQTFDO0FBQ0EsUUFBTUMsa0JBQWtCVCxZQUFZTyxRQUFaLENBQXFCRyxPQUFyQixDQUE2QkMsT0FBckQ7QUFDQSxRQUFNQyxtQkFBbUJqQixZQUFZSyxXQUFaLENBQXpCO0FBQ0EsUUFBTWEsbUJBQW1CWixPQUFPYSxVQUFQLEVBQXpCO0FBQ0EsUUFBTUMsWUFBWSxLQUFLbkIsUUFBUSw4QkFBUixDQUFMLEVBQ2hCYSxlQURnQixDQUFsQjtBQUdBLFFBQU1PLGlCQUFpQmYsT0FBT2dCLGtCQUFQLENBQTBCRixTQUExQixDQUF2Qjs7QUFFQVosZUFBYWUsS0FBYixDQUNFO0FBQ0VDLFFBQUksc0NBRE47QUFFRVAsb0JBRkY7QUFHRU4sZ0JBSEY7QUFJRU8sb0JBSkY7QUFLRUcsa0JBTEY7QUFNRUUsV0FBT2hCLENBTlQ7QUFPRWtCLGtCQUFjbEIsRUFBRW1CLE9BUGxCO0FBUUVDLGdCQUFZcEIsRUFBRXFCO0FBUmhC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Z0JBQVlwRCxRQUFRb0Q7QUFGdEIsR0FERixFQUtFLENBQUUsU0FBUXBELFFBQVFvRCxVQUFXLGtCQUE3QixFQUFnRGxDLElBQWhELENBQXFELElBQXJELENBTEY7QUFPRCxDQVREOztBQVdBOUIsUUFBUWlFLHNCQUFSLEdBQWlDLENBQUN4RCxRQUFELEVBQVdHLE9BQVgsS0FBdUI7QUFDdEQsUUFBTW1ELGlCQUFpQkYsWUFBWXBELFFBQVosQ0FBdkI7QUFDQXNELGlCQUFlM0MsS0FBZixDQUNFO0FBQ0VDLFFBQUksMkJBRE47QUFFRTZDLGFBQVN0RCxRQUFRc0QsT0FGbkI7QUFHRUMsZUFBV3ZELFFBQVF1RDtBQUhyQixHQURGLEVBTUUsQ0FDRyxzREFESCxFQUVHLCtDQUZILEVBR0VyQyxJQUhGLENBR08sSUFIUCxDQU5GO0FBV0QsQ0FiRDs7QUFlQTlCLFFBQVFvRSx1QkFBUixHQUFrQyxDQUFDM0QsUUFBRCxFQUFXVyxLQUFYLEtBQXFCO0FBQ3JELFFBQU0yQyxpQkFBaUJGLFlBQVlwRCxRQUFaLENBQXZCO0FBQ0FzRCxpQkFBZTNDLEtBQWYsQ0FDRTtBQUNFQyxRQUFJLDZCQUROO0FBRUVEO0FBRkYsR0FERixFQUtHLHdDQUF1Q0EsTUFBTUssS0FBTSxFQUx0RDtBQU9ELENBVEQ7O0FBV0F6QixRQUFRcUUsdUJBQVIsR0FBa0M1RCxZQUFZO0FBQzVDLFFBQU1zRCxpQkFBaUJGLFlBQVlwRCxRQUFaLENBQXZCO0FBQ0FzRCxpQkFBZTNDLEtBQWYsQ0FDRTtBQUNFQyxRQUFJO0FBRE4sR0FERixFQUlHLDRDQUpIO0FBTUQsQ0FSRCIsImZpbGUiOiJoYXJkLXNvdXJjZS13ZWJwYWNrLXBsdWdpbi9saWIvdXRpbC9sb2ctbWVzc2FnZXMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBjYWNoZVByZWZpeCA9IHJlcXVpcmUoJy4nKS5jYWNoZVByZWZpeDtcbmNvbnN0IExvZ2dlckZhY3RvcnkgPSByZXF1aXJlKCcuLi9sb2dnZXJGYWN0b3J5Jyk7XG5cbmV4cG9ydHMubW9kdWxlRnJlZXplRXJyb3IgPSAoY29tcGlsYXRpb24sIG1vZHVsZSwgZSkgPT4ge1xuICBjb25zdCBsb2dnZXJTZXJpYWwgPSBMb2dnZXJGYWN0b3J5LmdldExvZ2dlcihjb21waWxhdGlvbikuZnJvbSgnc2VyaWFsJyk7XG4gIGNvbnN0IGNvbXBpbGVyTmFtZSA9IGNvbXBpbGF0aW9uLmNvbXBpbGVyLm5hbWU7XG4gIGNvbnN0IGNvbXBpbGVyQ29udGV4dCA9IGNvbXBpbGF0aW9uLmNvbXBpbGVyLm9wdGlvbnMuY29udGV4dDtcbiAgY29uc3QgaWRlbnRpZmllclByZWZpeCA9IGNhY2hlUHJlZml4KGNvbXBpbGF0aW9uKTtcbiAgY29uc3QgbW9kdWxlSWRlbnRpZmllciA9IG1vZHVsZS5pZGVudGlmaWVyKCk7XG4gIGNvbnN0IHNob3J0ZW5lciA9IG5ldyAocmVxdWlyZSgnd2VicGFjay9saWIvUmVxdWVzdFNob3J0ZW5lcicpKShcbiAgICBjb21waWxlckNvbnRleHQsXG4gICk7XG4gIGNvbnN0IG1vZHVsZVJlYWRhYmxlID0gbW9kdWxlLnJlYWRhYmxlSWRlbnRpZmllcihzaG9ydGVuZXIpO1xuXG4gIGxvZ2dlclNlcmlhbC5lcnJvcihcbiAgICB7XG4gICAgICBpZDogJ3NlcmlhbGl6YXRpb24tLWVycm9yLWZyZWV6aW5nLW1vZHVsZScsXG4gICAgICBpZGVudGlmaWVyUHJlZml4LFxuICAgICAgY29tcGlsZXJOYW1lLFxuICAgICAgbW9kdWxlSWRlbnRpZmllcixcbiAgICAgIG1vZHVsZVJlYWRhYmxlLFxuICAgICAgZXJyb3I6IGUsXG4gICAgICBlcnJvck1lc3NhZ2U6IGUubWVzc2FnZSxcbiAgICAgIGVycm9yU3RhY2s6IGUuc3RhY2ssXG4gICAgfSxcbiAgICBgVW5hYmxlIHRvIGZyZWV6ZSBtb2R1bGUgXCIke21vZHVsZVJlYWRhYmxlfSR7XG4gICAgICBjb21waWxlck5hbWUgPyBgXCIgaW4gY29tcGlsYXRpb24gXCIke2NvbXBpbGVyTmFtZX1gIDogJydcbiAgICB9XCIuIEFuIGVycm9yIG9jY3VyZWQgc2VyaWFsaXppbmcgaXQgaW50byBhIHN0cmluZzogJHtlLm1lc3NhZ2V9YCxcbiAgKTtcbn07XG5cbmV4cG9ydHMuY2FjaGVOb1Bhcml0eSA9IChjb21waWxlciwgeyBwYXJpdHlSb290IH0pID0+IHtcbiAgY29uc3QgbG9nZ2VyU2VyaWFsID0gbmV3IExvZ2dlckZhY3RvcnkoY29tcGlsZXIpLmNyZWF0ZSgpLmZyb20oJ3NlcmlhbCcpO1xuICBsb2dnZXJTZXJpYWwuZXJyb3IoXG4gICAge1xuICAgICAgaWQ6ICdzZXJpYWx6YXRpb24tLWNhY2hlLWluY29tcGxldGUnLFxuICAgICAgcGFyaXR5Um9vdCxcbiAgICB9LFxuICAgIFtcbiAgICAgIGBQcmV2aW91cyBjYWNoZSBkaWQgbm90IGNvbXBsZXRlIHBhcml0eSBjaGVjay4gJHtwYXJpdHlSb290LnJlYXNvbn1gLFxuICAgICAgJ1Jlc2V0dGluZyBjYWNoZS4nLFxuICAgIF0uam9pbignXFxuJyksXG4gICk7XG59O1xuXG5leHBvcnRzLnNlcmlhbEJhZENhY2hlID0gKGNvbXBpbGVyLCBlcnJvcikgPT4ge1xuICBjb25zdCBsb2dnZXJTZXJpYWwgPSBuZXcgTG9nZ2VyRmFjdG9yeShjb21waWxlcikuY3JlYXRlKCkuZnJvbSgnc2VyaWFsJyk7XG4gIGxvZ2dlclNlcmlhbC5lcnJvcihcbiAgICB7XG4gICAgICBpZDogJ3NlcmlhbHphdGlvbi0tYmFkLWNhY2hlJyxcbiAgICB9LFxuICAgIFsnQ2FjaGUgaXMgY29ycnVwdGVkLicsIGVycm9yLnN0YWNrIHx8IGVycm9yLm1lc3NhZ2UgfHwgZXJyb3JdLmpvaW4oJ1xcbicpLFxuICApO1xufTtcblxuY29uc3QgbG9nQ29yZSA9IGNvbXBpbGVyID0+IG5ldyBMb2dnZXJGYWN0b3J5KGNvbXBpbGVyKS5jcmVhdGUoKS5mcm9tKCdjb3JlJyk7XG5cbmV4cG9ydHMuY29uZmlnSGFzaFNldEJ1dE5vdFVzZWQgPSAoY29tcGlsZXIsIHsgY2FjaGVEaXJlY3RvcnkgfSkgPT4ge1xuICBjb25zdCBsb2dnZXJDb3JlID0gbG9nQ29yZShjb21waWxlcik7XG4gIGxvZ2dlckNvcmUuZXJyb3IoXG4gICAge1xuICAgICAgaWQ6ICdjb25maWdoYXNoLS1kaXJlY3Rvcnktbm8tY29uZmlnaGFzaCcsXG4gICAgICBjYWNoZURpcmVjdG9yeTogY2FjaGVEaXJlY3RvcnksXG4gICAgfSxcbiAgICAnSGFyZFNvdXJjZVdlYnBhY2tQbHVnaW4gY2Fubm90IHVzZSBbY29uZmlnaGFzaF0gaW4gY2FjaGVEaXJlY3RvcnkgJyArXG4gICAgICAnd2l0aG91dCBjb25maWdIYXNoIG9wdGlvbiBiZWluZyBzZXQgYW5kIHJldHVybmluZyBhIG5vbi1mYWxzeSB2YWx1ZS4nLFxuICApO1xufTtcblxuZXhwb3J0cy5jb25maWdIYXNoRmlyc3RCdWlsZCA9IChjb21waWxlciwgeyBjYWNoZURpclBhdGgsIGNvbmZpZ0hhc2ggfSkgPT4ge1xuICBjb25zdCBsb2dnZXJDb3JlID0gbG9nQ29yZShjb21waWxlcik7XG4gIGxvZ2dlckNvcmUubG9nKFxuICAgIHtcbiAgICAgIGlkOiAnY29uZmlnaGFzaC0tbmV3JyxcbiAgICAgIGNhY2hlRGlyUGF0aCxcbiAgICAgIGNvbmZpZ0hhc2gsXG4gICAgfSxcbiAgICBgSGFyZFNvdXJjZVdlYnBhY2tQbHVnaW4gaXMgd3JpdGluZyB0byBhIG5ldyBjb25maWdoYXNoIHBhdGggZm9yIHRoZSBmaXJzdCB0aW1lOiAke2NhY2hlRGlyUGF0aH1gLFxuICApO1xufTtcblxuZXhwb3J0cy5jb25maWdIYXNoQnVpbGRXaXRoID0gKGNvbXBpbGVyLCB7IGNhY2hlRGlyUGF0aCwgY29uZmlnSGFzaCB9KSA9PiB7XG4gIGNvbnN0IGxvZ2dlckNvcmUgPSBsb2dDb3JlKGNvbXBpbGVyKTtcbiAgbG9nZ2VyQ29yZS5sb2coXG4gICAge1xuICAgICAgaWQ6ICdjb25maWdoYXNoLS1yZXVzZWQnLFxuICAgICAgY2FjaGVEaXJQYXRoLFxuICAgICAgY29uZmlnSGFzaCxcbiAgICB9LFxuICAgIGBIYXJkU291cmNlV2VicGFja1BsdWdpbiBpcyByZWFkaW5nIGZyb20gYW5kIHdyaXRpbmcgdG8gYSBjb25maWdoYXNoIHBhdGg6ICR7Y2FjaGVEaXJQYXRofWAsXG4gICk7XG59O1xuXG5leHBvcnRzLmRlbGV0ZU9sZENhY2hlcyA9IChjb21waWxlciwgeyBuZXdUb3RhbFNpemUsIG9sZFRvdGFsU2l6ZSB9KSA9PiB7XG4gIGNvbnN0IGxvZ2dlckNvcmUgPSBsb2dDb3JlKGNvbXBpbGVyKTtcbiAgY29uc3Qgc2l6ZU1CID0gTWF0aC5jZWlsKG5ld1RvdGFsU2l6ZSAvIDEwMjQgLyAxMDI0KTtcbiAgY29uc3QgZGVsZXRlZFNpemVNQiA9IE1hdGguY2VpbChvbGRUb3RhbFNpemUgLyAxMDI0IC8gMTAyNCk7XG4gIGxvZ2dlckNvcmUubG9nKFxuICAgIHtcbiAgICAgIGlkOiAnY2FjaGVzLS1kZWxldGUtb2xkJyxcbiAgICAgIHNpemU6IG5ld1RvdGFsU2l6ZSxcbiAgICAgIHNpemVNQixcbiAgICAgIGRlbGV0ZWRTaXplOiBvbGRUb3RhbFNpemUsXG4gICAgICBkZWxldGVkU2l6ZU1CLFxuICAgIH0sXG4gICAgYEhhcmRTb3VyY2VXZWJwYWNrUGx1Z2luIGlzIHVzaW5nICR7c2l6ZU1CfSBNQiBvZiBkaXNrIHNwYWNlIGFmdGVyIGRlbGV0aW5nICR7ZGVsZXRlZFNpemVNQn0gTUIuYCxcbiAgKTtcbn07XG5cbmV4cG9ydHMua2VlcENhY2hlcyA9IChjb21waWxlciwgeyB0b3RhbFNpemUgfSkgPT4ge1xuICBjb25zdCBsb2dnZXJDb3JlID0gbG9nQ29yZShjb21waWxlcik7XG4gIGNvbnN0IHNpemVNQiA9IE1hdGguY2VpbCh0b3RhbFNpemUgLyAxMDI0IC8gMTAyNCk7XG4gIGxvZ2dlckNvcmUubG9nKFxuICAgIHtcbiAgICAgIGlkOiAnY2FjaGVzLS1rZWVwJyxcbiAgICAgIHNpemU6IHRvdGFsU2l6ZSxcbiAgICAgIHNpemVNQixcbiAgICB9LFxuICAgIGBIYXJkU291cmNlV2VicGFja1BsdWdpbiBpcyB1c2luZyAke3NpemVNQn0gTUIgb2YgZGlzayBzcGFjZS5gLFxuICApO1xufTtcblxuZXhwb3J0cy5lbnZpcm9ubWVudElucHV0cyA9IChjb21waWxlciwgeyBpbnB1dHMgfSkgPT4ge1xuICBjb25zdCBsb2dnZXJDb3JlID0gbG9nQ29yZShjb21waWxlcik7XG4gIGxvZ2dlckNvcmUubG9nKFxuICAgIHtcbiAgICAgIGlkOiAnZW52aXJvbm1lbnQtLWlucHV0cycsXG4gICAgICBpbnB1dHMsXG4gICAgfSxcbiAgICBgVHJhY2tpbmcgZW52aXJvbm1lbnQgY2hhbmdlcyB3aXRoICR7aW5wdXRzLmpvaW4oJywgJyl9LmAsXG4gICk7XG59O1xuXG5leHBvcnRzLmNvbmZpZ0hhc2hDaGFuZ2VkID0gY29tcGlsZXIgPT4ge1xuICBjb25zdCBsb2dnZXJDb3JlID0gbG9nQ29yZShjb21waWxlcik7XG4gIGxvZ2dlckNvcmUud2FybihcbiAgICB7XG4gICAgICBpZDogJ2Vudmlyb25tZW50LS1jb25maWctY2hhbmdlZCcsXG4gICAgfSxcbiAgICAnRW52aXJvbm1lbnQgaGFzIGNoYW5nZWQgKGNvbmZpZ3VyYXRpb24gd2FzIGNoYW5nZWQpLlxcbicgK1xuICAgICAgJ0hhcmRTb3VyY2VXZWJwYWNrUGx1Z2luIHdpbGwgcmVzZXQgdGhlIGNhY2hlIGFuZCBzdG9yZSBhIGZyZXNoIG9uZS4nLFxuICApO1xufTtcblxuZXhwb3J0cy5lbnZpcm9ubWVudEhhc2hDaGFuZ2VkID0gY29tcGlsZXIgPT4ge1xuICBjb25zdCBsb2dnZXJDb3JlID0gbG9nQ29yZShjb21waWxlcik7XG4gIGxvZ2dlckNvcmUud2FybihcbiAgICB7XG4gICAgICBpZDogJ2Vudmlyb25tZW50LS1jaGFuZ2VkJyxcbiAgICB9LFxuICAgICdFbnZpcm9ubWVudCBoYXMgY2hhbmdlZCAobm9kZV9tb2R1bGVzIHdhcyB1cGRhdGVkKS5cXG4nICtcbiAgICAgICdIYXJkU291cmNlV2VicGFja1BsdWdpbiB3aWxsIHJlc2V0IHRoZSBjYWNoZSBhbmQgc3RvcmUgYSBmcmVzaCBvbmUuJyxcbiAgKTtcbn07XG5cbmV4cG9ydHMuaGFyZFNvdXJjZVZlcnNpb25DaGFuZ2VkID0gY29tcGlsZXIgPT4ge1xuICBjb25zdCBsb2dnZXJDb3JlID0gbG9nQ29yZShjb21waWxlcik7XG4gIGxvZ2dlckNvcmUud2FybihcbiAgICB7XG4gICAgICBpZDogJ2Vudmlyb25tZW50LS1oYXJkc291cmNlLWNoYW5nZWQnLFxuICAgIH0sXG4gICAgJ0luc3RhbGxlZCBIYXJkU291cmNlIHZlcnNpb24gZG9lcyBub3QgbWF0Y2ggdGhlIHNhdmVkICcgK1xuICAgICAgJ2NhY2hlLlxcbkhhcmRTb3VyY2VXZWJwYWNrUGx1Z2luIHdpbGwgcmVzZXQgdGhlIGNhY2hlIGFuZCBzdG9yZSAnICtcbiAgICAgICdhIGZyZXNoIG9uZS4nLFxuICApO1xufTtcblxuZXhwb3J0cy5jaGlsZENvbXBpbGVyV2l0aG91dENhY2hlID0gY29tcGlsYXRpb24gPT4ge1xuICB2YXIgbG9nZ2VyVXRpbCA9IExvZ2dlckZhY3RvcnkuZ2V0TG9nZ2VyKGNvbXBpbGF0aW9uKS5mcm9tKCd1dGlsJyk7XG4gIGxvZ2dlclV0aWwuZXJyb3IoXG4gICAge1xuICAgICAgaWQ6ICdjaGlsZGNvbXBpbGVyLS1uby1jYWNoZScsXG4gICAgICBjb21waWxlck5hbWU6IGNvbXBpbGF0aW9uLmNvbXBpbGVyLm5hbWUsXG4gICAgfSxcbiAgICBbXG4gICAgICBgQSBjaGlsZCBjb21waWxlciAoJHtjb21waWxhdGlvbi5jb21waWxlci5uYW1lfSkgZG9lcyBub3RgLFxuICAgICAgXCJoYXZlIGEgbWVtb3J5IGNhY2hlLiBFbmFibGUgYSBtZW1vcnkgY2FjaGUgd2l0aCB3ZWJwYWNrJ3NcIixcbiAgICAgICdgY2FjaGVgIGNvbmZpZ3VyYXRpb24gb3B0aW9uLiBIYXJkU291cmNlV2VicGFja1BsdWdpbiB3aWxsIGJlJyxcbiAgICAgICdkaXNhYmxlZCBmb3IgdGhpcyBjaGlsZCBjb21waWxlciB1bnRpbCB0aGVuLicsXG4gICAgXS5qb2luKCdcXG4nKSxcbiAgKTtcbn07XG5cbmV4cG9ydHMuY2hpbGRDb21waWxlclVubmFtZWRDYWNoZSA9IGNvbXBpbGF0aW9uID0+IHtcbiAgdmFyIGxvZ2dlclV0aWwgPSBMb2dnZXJGYWN0b3J5LmdldExvZ2dlcihjb21waWxhdGlvbikuZnJvbSgndXRpbCcpO1xuICBsb2dnZXJVdGlsLmVycm9yKFxuICAgIHtcbiAgICAgIGlkOiAnY2hpbGRjb21waWxlci0tdW5uYW1lZC1jYWNoZScsXG4gICAgICBjb21waWxlck5hbWU6IGNvbXBpbGF0aW9uLmNvbXBpbGVyLm5hbWUsXG4gICAgfSxcbiAgICBbXG4gICAgICBgQSBjaGlsZCBjb21waWxlciAoJHtjb21waWxhdGlvbi5jb21waWxlci5uYW1lfSkgaGFzIGFgLFxuICAgICAgJ21lbW9yeSBjYWNoZSBidXQgaXRzIGNhY2hlIG5hbWUgaXMgdW5rbm93bi4nLFxuICAgICAgJ0hhcmRTb3VyY2VXZWJwYWNrUGx1Z2luIHdpbGwgYmUgZGlzYWJsZWQgZm9yIHRoaXMgY2hpbGQnLFxuICAgICAgJ2NvbXBpbGVyLicsXG4gICAgXS5qb2luKCdcXG4nKSxcbiAgKTtcbn07XG5cbmNvbnN0IGxvZ1BhcmFsbGVsID0gY29tcGlsZXIgPT5cbiAgbmV3IExvZ2dlckZhY3RvcnkoY29tcGlsZXIpLmNyZWF0ZSgpLmZyb20oJ3BhcmFsbGVsJyk7XG5cbmV4cG9ydHMucGFyYWxsZWxTdGFydFdvcmtlcnMgPSAoY29tcGlsZXIsIG9wdGlvbnMpID0+IHtcbiAgY29uc3QgbG9nZ2VyUGFyYWxsZWwgPSBsb2dQYXJhbGxlbChjb21waWxlcik7XG4gIGxvZ2dlclBhcmFsbGVsLmxvZyhcbiAgICB7XG4gICAgICBpZDogJ3BhcmFsbGVsLS1zdGFydC13b3JrZXJzJyxcbiAgICAgIG51bVdvcmtlcnM6IG9wdGlvbnMubnVtV29ya2VycyxcbiAgICB9LFxuICAgIFtgU3RhcnQgJHtvcHRpb25zLm51bVdvcmtlcnN9IG1vZHVsZSB3b3JrZXJzLmBdLmpvaW4oJ1xcbicpLFxuICApO1xufTtcblxuZXhwb3J0cy5wYXJhbGxlbENvbmZpZ01pc21hdGNoID0gKGNvbXBpbGVyLCBvcHRpb25zKSA9PiB7XG4gIGNvbnN0IGxvZ2dlclBhcmFsbGVsID0gbG9nUGFyYWxsZWwoY29tcGlsZXIpO1xuICBsb2dnZXJQYXJhbGxlbC5lcnJvcihcbiAgICB7XG4gICAgICBpZDogJ3BhcmFsbGVsLS1jb25maWctbWlzbWF0Y2gnLFxuICAgICAgb3VySGFzaDogb3B0aW9ucy5vdXJIYXNoLFxuICAgICAgdGhlaXJIYXNoOiBvcHRpb25zLnRoZWlySGFzaCxcbiAgICB9LFxuICAgIFtcbiAgICAgIGBDaGlsZCBwcm9jZXNzJ3MgY29uZmlndXJhdGlvbiBkb2VzIG5vdCBtYXRjaCBwYXJlbnQgYCxcbiAgICAgIGBjb25maWd1cmF0aW9uLiBVbmFibGUgdG8gcGFyYWxsZWxpemUgd2VicGFjay5gLFxuICAgIF0uam9pbignXFxuJyksXG4gICk7XG59O1xuXG5leHBvcnRzLnBhcmFsbGVsRXJyb3JTZW5kaW5nSm9iID0gKGNvbXBpbGVyLCBlcnJvcikgPT4ge1xuICBjb25zdCBsb2dnZXJQYXJhbGxlbCA9IGxvZ1BhcmFsbGVsKGNvbXBpbGVyKTtcbiAgbG9nZ2VyUGFyYWxsZWwuZXJyb3IoXG4gICAge1xuICAgICAgaWQ6ICdwYXJhbGxlbC0tZXJyb3Itc2VuZGluZy1qb2InLFxuICAgICAgZXJyb3IsXG4gICAgfSxcbiAgICBgRmFpbGVkIHRvIHNlbmQgcGFyYWxsZWwgbW9kdWxlIHdvcmsuICR7ZXJyb3Iuc3RhY2t9YCxcbiAgKTtcbn07XG5cbmV4cG9ydHMucGFyYWxsZWxSZXF1aXJlV2VicGFjazQgPSBjb21waWxlciA9PiB7XG4gIGNvbnN0IGxvZ2dlclBhcmFsbGVsID0gbG9nUGFyYWxsZWwoY29tcGlsZXIpO1xuICBsb2dnZXJQYXJhbGxlbC5lcnJvcihcbiAgICB7XG4gICAgICBpZDogJ3BhcmFsbGVsLS13ZWJwYWNrLTQnLFxuICAgIH0sXG4gICAgYFBhcmFsbGVsIE1vZHVsZSBQbHVnaW4gcmVxdWlyZXMgd2VicGFjayA0LmAsXG4gICk7XG59O1xuIl0sInNvdXJjZVJvb3QiOiIvVXNlcnMvdHlsZXJhcmJ1cy9kZXYvcHJvdmlkZXIvc3JjIn0=
