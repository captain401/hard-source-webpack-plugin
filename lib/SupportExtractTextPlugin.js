'use strict';

require('source-map-support/register');

const path = require('path');

let extractTextNS;
let extractTextNS2;
try {
  extractTextNS = path.dirname(require.resolve('extract-text-webpack-plugin'));
} catch (_) {}

const pluginCompat = require('./util/plugin-compat');

class SupportExtractTextPlugin {
  apply(compiler) {
    pluginCompat.tap(compiler, '_hardSourceAfterFreezeModule', 'SupportExtractTextPlugin', (frozen, module, extra) => {
      // Ignore the modules that kick off child compilers in extract text.
      // These modules must always be built so the child compilers run so
      // that assets get built.
      if (module[extractTextNS] || !module.buildMeta && module.meta && module.meta[extractTextNS]) {
        return null;
      }

      return frozen;
    });
  }
}

module.exports = SupportExtractTextPlugin;
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImhhcmQtc291cmNlLXdlYnBhY2stcGx1Z2luL2xpYi9TdXBwb3J0RXh0cmFjdFRleHRQbHVnaW4uanMiXSwibmFtZXMiOlsicGF0aCIsInJlcXVpcmUiLCJleHRyYWN0VGV4dE5TIiwiZXh0cmFjdFRleHROUzIiLCJkaXJuYW1lIiwicmVzb2x2ZSIsIl8iLCJwbHVnaW5Db21wYXQiLCJTdXBwb3J0RXh0cmFjdFRleHRQbHVnaW4iLCJhcHBseSIsImNvbXBpbGVyIiwidGFwIiwiZnJvemVuIiwibW9kdWxlIiwiZXh0cmEiLCJidWlsZE1ldGEiLCJtZXRhIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE1BQU1BLE9BQU9DLFFBQVEsTUFBUixDQUFiOztBQUVBLElBQUlDLGFBQUo7QUFDQSxJQUFJQyxjQUFKO0FBQ0EsSUFBSTtBQUNGRCxrQkFBZ0JGLEtBQUtJLE9BQUwsQ0FBYUgsUUFBUUksT0FBUixDQUFnQiw2QkFBaEIsQ0FBYixDQUFoQjtBQUNELENBRkQsQ0FFRSxPQUFPQyxDQUFQLEVBQVUsQ0FBRTs7QUFFZCxNQUFNQyxlQUFlTixRQUFRLHNCQUFSLENBQXJCOztBQUVBLE1BQU1PLHdCQUFOLENBQStCO0FBQzdCQyxRQUFNQyxRQUFOLEVBQWdCO0FBQ2RILGlCQUFhSSxHQUFiLENBQ0VELFFBREYsRUFFRSw4QkFGRixFQUdFLDBCQUhGLEVBSUUsQ0FBQ0UsTUFBRCxFQUFTQyxNQUFULEVBQWlCQyxLQUFqQixLQUEyQjtBQUN6QjtBQUNBO0FBQ0E7QUFDQSxVQUNFRCxPQUFPWCxhQUFQLEtBQ0MsQ0FBQ1csT0FBT0UsU0FBUixJQUFxQkYsT0FBT0csSUFBNUIsSUFBb0NILE9BQU9HLElBQVAsQ0FBWWQsYUFBWixDQUZ2QyxFQUdFO0FBQ0EsZUFBTyxJQUFQO0FBQ0Q7O0FBRUQsYUFBT1UsTUFBUDtBQUNELEtBaEJIO0FBa0JEO0FBcEI0Qjs7QUF1Qi9CQyxPQUFPSSxPQUFQLEdBQWlCVCx3QkFBakIiLCJmaWxlIjoiaGFyZC1zb3VyY2Utd2VicGFjay1wbHVnaW4vbGliL1N1cHBvcnRFeHRyYWN0VGV4dFBsdWdpbi5qcyIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IHBhdGggPSByZXF1aXJlKCdwYXRoJyk7XG5cbmxldCBleHRyYWN0VGV4dE5TO1xubGV0IGV4dHJhY3RUZXh0TlMyO1xudHJ5IHtcbiAgZXh0cmFjdFRleHROUyA9IHBhdGguZGlybmFtZShyZXF1aXJlLnJlc29sdmUoJ2V4dHJhY3QtdGV4dC13ZWJwYWNrLXBsdWdpbicpKTtcbn0gY2F0Y2ggKF8pIHt9XG5cbmNvbnN0IHBsdWdpbkNvbXBhdCA9IHJlcXVpcmUoJy4vdXRpbC9wbHVnaW4tY29tcGF0Jyk7XG5cbmNsYXNzIFN1cHBvcnRFeHRyYWN0VGV4dFBsdWdpbiB7XG4gIGFwcGx5KGNvbXBpbGVyKSB7XG4gICAgcGx1Z2luQ29tcGF0LnRhcChcbiAgICAgIGNvbXBpbGVyLFxuICAgICAgJ19oYXJkU291cmNlQWZ0ZXJGcmVlemVNb2R1bGUnLFxuICAgICAgJ1N1cHBvcnRFeHRyYWN0VGV4dFBsdWdpbicsXG4gICAgICAoZnJvemVuLCBtb2R1bGUsIGV4dHJhKSA9PiB7XG4gICAgICAgIC8vIElnbm9yZSB0aGUgbW9kdWxlcyB0aGF0IGtpY2sgb2ZmIGNoaWxkIGNvbXBpbGVycyBpbiBleHRyYWN0IHRleHQuXG4gICAgICAgIC8vIFRoZXNlIG1vZHVsZXMgbXVzdCBhbHdheXMgYmUgYnVpbHQgc28gdGhlIGNoaWxkIGNvbXBpbGVycyBydW4gc29cbiAgICAgICAgLy8gdGhhdCBhc3NldHMgZ2V0IGJ1aWx0LlxuICAgICAgICBpZiAoXG4gICAgICAgICAgbW9kdWxlW2V4dHJhY3RUZXh0TlNdIHx8XG4gICAgICAgICAgKCFtb2R1bGUuYnVpbGRNZXRhICYmIG1vZHVsZS5tZXRhICYmIG1vZHVsZS5tZXRhW2V4dHJhY3RUZXh0TlNdKVxuICAgICAgICApIHtcbiAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBmcm96ZW47XG4gICAgICB9LFxuICAgICk7XG4gIH1cbn1cblxubW9kdWxlLmV4cG9ydHMgPSBTdXBwb3J0RXh0cmFjdFRleHRQbHVnaW47XG4iXSwic291cmNlUm9vdCI6Ii9Vc2Vycy90eWxlcmFyYnVzL2Rldi9wcm92aWRlci9zcmMifQ==
